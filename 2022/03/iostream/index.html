<!DOCTYPE html>
<html lang="en" >

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta property="og:title" content="IOStream" />
<meta property="og:description" content="记录 File class 和 IO Stream" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://junq0420.github.io/2022/03/iostream/" />
<meta property="article:published_time" content="2022-03-14T09:25:37+08:00" />
<meta property="article:modified_time" content="2022-03-14T09:25:37+08:00" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="IOStream"/>
<meta name="twitter:description" content="记录 File class 和 IO Stream"/>
<meta name="generator" content="Hugo 0.84.0" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "IOStream",
  "url": "https://junq0420.github.io/2022/03/iostream/",
  "wordCount": "1386",
  "datePublished": "2022-03-14T09:25:37+08:00",
  "dateModified": "2022-03-14T09:25:37+08:00",
  "author": {
    "@type": "Person",
    "name": "Jun qiang"
  },
  "keywords": "Java, Java_Advance"
}
</script>



    <link rel="canonical" href="https://junq0420.github.io/2022/03/iostream/">

    <title>IOStream | My Blog</title>

    
    <!-- combined, minified CSS -->
    
    <link href="https://junq0420.github.io/css/style.160a3bda53be859332fff3fc376b5fd76a285126483463aa2e24a17ae1bcae4c.css" rel="stylesheet" integrity="sha256-Fgo72lO&#43;hZMy//P8N2tf12ooUSZINGOqLiSheuG8rkw=" crossorigin="anonymous">
    

    <!-- minified Font Awesome for SVG icons -->
    
    <script defer src="https://junq0420.github.io/js/fontawesome.min.f5072c55a0721857184db93a50561d7dc13975b4de2e19db7f81eb5f3fa57270.js" integrity="sha256-9QcsVaByGFcYTbk6UFYdfcE5dbTeLhnbf4HrXz&#43;lcnA=" crossorigin="anonymous"></script>

    <!-- RSS 2.0 feed -->
    

    

  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="https://junq0420.github.io">Home</a>
          
          <a class="nav-link" href="/archives/" title="">Archives</a>
          
          
          <a class="nav-link" href="/categories/" title="">Categories</a>
          
          
          <a class="nav-link" href="/tags/" title="">Tags</a>
          
        </nav>
      </div>
    </div>
    

    
    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title" dir="auto"><a href="https://junq0420.github.io" rel="home">My Blog</a></h1>
        <p class="lead blog-description" dir="auto"><ul>
<li>保持兴趣，持续学习 :)</li>
</ul>
</p>
      </div>
    </header>
    
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title" dir="auto"><a href="https://junq0420.github.io/2022/03/iostream/">IOStream</a></h2>
    <p class="blog-post-meta">
<time datetime="2022-03-14T09:25:37+08:00">2022-03-14</time>
 in 
<span class="fas fa-folder" aria-hidden="true"></span>&nbsp;<a href="/categories/java/" rel="category tag">Java</a>


<span class="fas fa-tag" aria-hidden="true"></span>&nbsp;<a href="/tags/java_advance/" rel="tag">Java_Advance</a>

</p>
  </header>
  <p>记录 File class 和 IO Stream</p>

<blockquote>
<p><strong>学习笔记，仅供参考</strong></p>

<p><strong>参考</strong>：<a href="https://www.yuque.com/books/share/ddbdba56-dc9f-4997-9e18-d9e69309d343/wgctzt">B站Mirco_Frank - java 进阶</a> | <a href="https://docs.oracle.com/javase/9/docs/api/index.html?overview-summary.html">官方文档英文版</a></p>
</blockquote>

<hr />

<style>
.icon {
    position: fixed;
    opacity: 50%;
    margin-top: 40%;
    margin-left: 90%;
}
</style>

<p><a name="return-top"></a>
        <div class="icon">
            <a href="#return-top">
                <img src="https://cdn.jsdelivr.net/gh/junq0420/blog_image/scroll_top.jpg
" alt="row" height="50px">
            </a>
        </div></p>

<hr />

<h2 id="目录">目录</h2>

<ul>
<li><p><a href="#FileClass">File class</a></p></li>

<li><p><a href="#I/OStream">I/O Stream</a></p>

<ul>
<li><p><a href="#字节流">字节流</a></p></li>

<li><p><a href="#文件字节流">文件字节流</a></p></li>

<li><p><a href="#缓冲字节流">缓冲字节流</a></p></li>

<li><p><a href="#字符流">字符流</a></p></li>

<li><p><a href="#转换流">转换流</a></p></li>

<li><p><a href="#数据流">数据流</a></p></li>

<li><p><a href="#对象流">对象流</a></p></li>
</ul></li>
</ul>

<hr />

<h2 id="a-name-fileclass-file-class-a">🧷 <a name="FileClass">File class</a></h2>

<p>File 类是对一个文件夹或文件路径的抽象表示，文件路径可以是 <strong>绝对路径</strong> (absolute path)抑或是 <strong>相对路径</strong> (relative path)</p>

<p>不同操作系统下，文件路径的分隔符会不同，<code>Unix</code> 下用 <code>/</code>; 而 <code>Win 10</code> 下用 <code>\\</code></p>

<h3 id="构造器">构造器</h3>

<p><code>File(String pathname)</code> &emsp; // 将所给的文件名转为抽象路径</p>

<h3 id="方法">方法</h3>

<p><a href="https://www.javatpoint.com/java-file-class">练习 file class</a></p>

<ul>
<li><p><strong><em><code>canExecute() | canRead() | canWrite()</code></em></strong> &emsp; // 判断该文件是否可执行 | 可读 | 可写</p></li>

<li><p><strong><em><code>length()</code></em></strong> &emsp; // 返回所给文件的字符长度</p></li>

<li><p><strong><em><code>exists()</code></em></strong> &emsp; // 判断所给的文件是否存在</p></li>

<li><p><strong><em><code>isAbsolute() | isDirectory() | isFile() | isHidden()</code></em></strong> &emsp; // 判断文件路径是否为绝对路径 | 该文件是否是文件夹 | 是否是文件 | 是否是隐藏文件</p></li>

<li><p><strong><em><code>createNewFile()</code></em></strong> &emsp; // 返回 true 表明该文件不存在，以该文件名为名创建新的空文件；返回 false 表明该文件已存在；用时还要处理 IOException</p></li>

<li><p><strong><em><code>delete()</code></em></strong> &emsp; // 删除该文件/文件夹</p></li>

<li><p><strong><em><code>mkdir()</code></em></strong> &emsp; // 以该抽象路径名创建文件夹</p></li>

<li><p><strong><em><code>getCanonicalFile()</code></em></strong> &emsp; // 获取该文件的规范形式文件，即绝对路径且唯一的，与操作系统有关；同样要处理异常</p></li>

<li><p><strong><em><code>getAbsolutePath()</code></em></strong> &emsp; // 获取该文件的绝对路径字符串</p></li>

<li><p><strong><em><code>getName()</code></em></strong> &emsp; // 获取该文件/文件夹的名</p></li>

<li><p><strong><em><code>getParent()</code></em></strong> &emsp; // 返回此文件的父目录的路径名字符串，如果此路径名未命名父目录，则返回 null。</p></li>

<li><p><strong><em><code>getPath()</code></em></strong> &emsp; // 获取文件的路径名</p></li>

<li><p><strong><em><code>list()</code></em></strong> &emsp; // 遍历获取此抽象路径下的所有文件和子文件夹，并以字符串的形式返回</p></li>

<li><p><strong><em><code>listFile()</code></em></strong> &emsp; // 遍历获取此抽象路径下的所有文件和子文件夹，并以 File 的形式返回</p></li>
</ul>

<hr />

<h2 id="a-name-i-ostream-i-o-stream-a">🌠 <a name="I/OStream">I/O Stream</a></h2>

<p><strong><code>I</code></strong>: input source; &emsp; <strong><code>O</code></strong>: output distination;  &emsp; <strong><code>Stream</code></strong>: the process/pipe (from source to dist or from dist to source) and it support many different kinds of data, include: <em>bytes</em>, <em>primitive data types</em>, <em>localized characters</em>, and <em>objects</em>.</p>

<p><a href="https://docs.oracle.com/javase/tutorial/essential/io/streams.html">官方教程解释 I/O Stream</a></p>

<p>下面以水库输水来说明流的过程</p>

<p><img src="https://cdn.jsdelivr.net/gh/junq0420/blog_image/Water_stream_exp.jpg" alt="Water_stream_exp" /></p>

<p>输入输出是有相对性的，可以从 src 到 dist, 或者 dist 到 src</p>

<p>接着来探讨程序中的 IO 流概念，在<code>程序中流就是一串数据</code>，当程序要 <code>从源读取数据</code> 时就要使用 <strong><code>input</code></strong>; 当程序要 <code>向源写入数据</code> 时就要使用 <strong><code>output</code></strong>。所以一切都是以程序为主，以它作为主角，输入输出都是相对它而言的。</p>

<p><img src="https://cdn.jsdelivr.net/gh/junq0420/blog_image/Input_output_difference.jpg" alt="IO" /></p>

<p>图片来自<a href="https://docs.oracle.com/javase/tutorial/essential/io/streams.html">官网文档</a></p>

<p>从图片中也可以看出，数据源/数据目标可以有很多种形式：另一个程序、文件、数据库等</p>

<hr />

<h3 id="a-name-字节流-字节流-a-inputstream-和-outputstream"><a name="字节流">字节流</a> InputStream 和 OutputStream</h3>

<p>InputStream 是抽象类，它是所有字节输入类的父类；同样，OutputStream 是所有字节输出类的父类。所有的 <strong>字节流类</strong> 都是继承自他俩</p>

<p>InputStream 的常用方法：<code>close()</code> - 当程序不在读数据时，关闭输入流；<code>read()</code> - 从输入流中读取下个字节</p>

<p>OutputStream 的常用方法：<code>close()</code> - 当程序不在写数据时，关闭输出流；<code>write(int b)</code> - 写字节到输出流中</p>

<p>因为抽象类的子类会重写父类的方法，所以上面的方法也是其子类常用的</p>

<hr />

<h3 id="a-name-文件字节流-fileinputstream-和-fileoutputstream-a"><a name="文件字节流">FileInputStream 和 FileOutputStream</a></h3>

<p>它俩用于读文件或写文件，通过字节的形式来完成。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fileInputStreamTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 创建文件流
</span><span style="color:#75715e"></span>        FileInputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/text.txt&#34;</span><span style="color:#f92672">);</span>

        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>            
            <span style="color:#66d9ef">int</span> c<span style="color:#f92672">;</span>
            <span style="color:#75715e">// 读取文件流源文件中的数据到程序中
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>c <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#75715e">// 将从文件流中获取的字节强转为 char 型
</span><span style="color:#75715e"></span>                <span style="color:#75715e">// 然后将其输入
</span><span style="color:#75715e"></span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">((</span><span style="color:#66d9ef">char</span><span style="color:#f92672">)</span> c<span style="color:#f92672">);</span>

        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
           <span style="color:#75715e">// 读取之后，关闭所用的文件流
</span><span style="color:#75715e"></span>           <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>in <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
               in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
           <span style="color:#f92672">}</span>
       <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>其中用到 <code>read()</code> 方法，它返回下个数据的字节，要是到底了就返回 -1；还有不论如何最后都要关流，以防止数据泄露</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fileOutputStreamTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 创建输出流
</span><span style="color:#75715e"></span>        FileOutputStream out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/output.txt&#34;</span><span style="color:#f92672">);</span>

        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            <span style="color:#75715e">// 因为是字节流写入，所以要将所写的 String 转为字节数组
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello World!&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">();</span>
            <span style="color:#75715e">// 将程序中的字节写入到输出流的目标文件中
</span><span style="color:#75715e"></span>            out<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>bytes<span style="color:#f92672">);</span>

        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>out <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#75715e">// 写好之后，关闭输出流
</span><span style="color:#75715e"></span>                out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>用 <code>write()</code> 方法将数据写入到目标文件中，放还有几个重载的方法，以满足不同字节类型输入</p>

<p>有了读取和写入，就可以满足对文件的读写要求了，后面只是对性能的提升。通过读写还可以完成文件的 copy 操作</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fileCopyTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 创建输入输出流
</span><span style="color:#75715e"></span>        FileInputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/input.txt&#34;</span><span style="color:#f92672">)</span>
        FileOutputStream out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/output.txt&#34;</span><span style="color:#f92672">);</span>

        <span style="color:#75715e">// 从 src 中读向 dist 中写
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">int</span> c<span style="color:#f92672">;</span>
            <span style="color:#75715e">// 单字节读取
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>c <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>c<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
            <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>in <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>out <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<hr />

<p>上面所用的是单个字节来进行数据的读写，就像搬砖一样，一次只搬一块砖就会显得效率太低。所以引入一个 byte[] 类型的 buffer 来增加一次搬运的容量，就像一次搬十块砖一样，效率就会提高很多。下面就来看看代码的实现</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fileCopyTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 创建输入输出流
</span><span style="color:#75715e"></span>        FileInputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/input.txt&#34;</span><span style="color:#f92672">)</span>
        FileOutputStream out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/output.txt&#34;</span><span style="color:#f92672">);</span>

        <span style="color:#75715e">// 读取数据到缓存区，缓存区大小为 1KB
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> buff <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>1024<span style="color:#f92672">];</span>
            <span style="color:#66d9ef">int</span> c<span style="color:#f92672">;</span>
            
            <span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>c <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>buff<span style="color:#f92672">))</span> <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>buff<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> c<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
            <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>in <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>out <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>从上述代码中，可以看到 buffer 的大小被设置为 1024 bytes(1KB)，同时还用到了 <code>read(byte[] b)</code> 和 <code>write(byte[], int off, int len)</code> 的重载方法，</p>

<ul>
<li><p><code>read(byte[] b)</code> &emsp; // 读取数据到 byte 数组中，并返回所读到的总字节数(即 1024, 数组的大小)，若没读到就返回 -1</p></li>

<li><p><code>write(byte[] b, int off, int len)</code> &emsp; // 将字节数组写到输出流中，off 指要从数组的哪开始写，len 指要写入多大的字节</p></li>
</ul>

<h3 id="a-name-缓冲字节流-bufferedinputstream-和-bufferedoutputstream-a"><a name="缓冲字节流">BufferedInputStream 和 BufferedOutputStream</a></h3>

<p>Java 作为高级语言，自然有直接可以用的字节缓存读写类，它们就是 BufferedInputStream 和 BufferedOutputStream ，其实是它们的内部新建了一个 byte 数组，原理上跟上面的差不多，只是它们使用起来要更加地方便</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fileCopyTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 创建字节缓存输入输出流
</span><span style="color:#75715e"></span>        BufferedInputStream buffIn <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/input.txt&#34;</span><span style="color:#f92672">));</span>
        BufferedOutputStream buffOut <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/output.txt&#34;</span><span style="color:#f92672">));</span>

        <span style="color:#75715e">// 读取数据
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">int</span> c<span style="color:#f92672">;</span>

            <span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>c <span style="color:#f92672">=</span> buffIn<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                buffOut<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>c<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
            <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>in <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>out <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>由于 <code>BufferedInputStream(InputStream in)</code> 构造器要接受一个输入流，所以用到 <code>new FileInputStream(&quot;xx/input.txt&quot;)</code> 来生成一个文件输入流，output 同理。本来用 FileInputStream 就可以完成读写，为了让读写更加高效，相当于给 FileInputStream 对象开了个 VIP 一样。所以要想开 VIP，你得先要注册账号(FileInputStream 对象)，在设计模式中这种类似升级 VIP 的服务叫 <code>装饰设计模式</code></p>

<p>心血来潮，顺便简要测试了单字节读写、手写缓存区读写、自带缓存区读写三种读写所消耗的时间</p>

<p><img src="https://cdn.jsdelivr.net/gh/junq0420/blog_image/Buffered_spend_time.jpg" alt="spend-time" /></p>

<p>由图可知，缓存区读写大约是单字节读写的十分之一，而手写的缓存区要稍慢于自带的，可能是内部建的 byte 数组底层优化的好</p>

<hr />

<h3 id="a-name-字符流-字符流-a-reader-writer"><a name="字符流">字符流</a> Reader &amp; Writer</h3>

<p>除了字节流外，还有字符流，但实质上字符还是用字节来表示。为了更方便地处理字符文本文件，所以有了 <code>Reader &amp; Writer</code>。与之前的 <code>InputStream &amp; OutputStream</code> 一样，它们也是抽象的，所有的 <strong>字符流</strong> 类都继承自他俩。</p>

<p>通常字符流用来读写文本文件更方便，字节流来读写视频、音频、图片等格式的文件更方便，详细查看<a href="https://www.zhihu.com/question/39262026">字符流与字节流的区别</a></p>

<p>同样提供了一些读写必要的方法 <code>close()</code>, <code>read()</code>, <code>write()</code></p>

<h3 id="filereader-filewriter">FileReader &amp; FileWriter</h3>

<p>它俩具体实现 Reader &amp; Writer 类</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fileReaderTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 新建输入流
</span><span style="color:#75715e"></span>        FileReader fr <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileReader<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/input.txt&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#75715e">// 读取数据
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> c<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>c <span style="color:#f92672">=</span> fr<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">((</span><span style="color:#66d9ef">char</span><span style="color:#f92672">)</span> c<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>fr <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            fr<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">/**********************分割线*********************/</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fileWriterTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 创建输出流
</span><span style="color:#75715e"></span>        FileWriter fr <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileWriter<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/output.txt&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#75715e">// 写入数据（直接将要写的字符串丢进去即可）
</span><span style="color:#75715e"></span>        fw<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hello world&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>fw <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            fw<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">/***************分割线********************/</span>

<span style="color:#75715e">// 复制的操作与字节流复制的一样，也是边读边写
</span><span style="color:#75715e">// 只不过只能读写文本文件
</span><span style="color:#75715e"></span>    </code></pre></div>
<p>同样，为了让读写更高效，有了 <code>BufferedReader &amp; BufferedWriter</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bufferedReaderTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 新建输入流
</span><span style="color:#75715e"></span>        BufferedReader buffReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Reader<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/input.txt&#34;</span><span style="color:#f92672">));</span>
        <span style="color:#75715e">// 以字符串的形式读取数据
</span><span style="color:#75715e"></span>        String str<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>str <span style="color:#f92672">=</span> buffReader<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>str<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>buffReader <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            buffReader<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>BufferedReader 可以使用 <code>readLine()</code> 方法来读取，要打印时就要是用 <code>System.out.println()</code> 来打印，否则文本中的回车换行就会不显示</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bufferedWriterTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 新建输入流
</span><span style="color:#75715e"></span>        BufferedWriter buffWriter <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedWriter<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Writer<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/output.txt&#34;</span><span style="color:#f92672">));</span>
        <span style="color:#75715e">// 以字符串的形式写入数据
</span><span style="color:#75715e"></span>        buffWriter<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hello&#34;</span><span style="color:#f92672">);</span>
        buffWriter<span style="color:#f92672">.</span><span style="color:#a6e22e">newLine</span><span style="color:#f92672">();</span>  <span style="color:#75715e">// 用该方法写入换行，防止不同系统的换行符不同而引起错误
</span><span style="color:#75715e"></span>        buffWriter<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;world!&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>buffWriter <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            buffWriter<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>复制的话也是类似的，下面仅列出读写数据的部分</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// 定义字符串变量来接收读取到的数据
</span><span style="color:#75715e"></span>String str<span style="color:#f92672">;</span>
<span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>str <span style="color:#f92672">=</span> buffReader<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    buffWriter<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>str<span style="color:#f92672">);</span>
    buffWriter<span style="color:#f92672">.</span><span style="color:#a6e22e">newLine</span><span style="color:#f92672">();</span>  <span style="color:#75715e">// 每写一行数据换一行
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span></code></pre></div>
<hr />

<h3 id="a-name-转换流-转换流-a-inputstreamreader-outputstreamwriter"><a name="转换流">转换流</a> (InputStreamReader &amp; OutputStreamWriter)</h3>

<p>它俩是作为字节和字符相互转换的桥梁，通过 <code>InputStreamReader</code> 可以将文件中的字节转为字符，然后进行读取；同样，<code>OutputStreamWriter</code> 是将写入的字符转为字节，然后放入文件中进行存储。</p>

<p>使用场合：</p>

<ol>
<li><p>源或目标所对应的设备是字节流，但操作的确实文本数据，可以使用其来作为桥梁</p></li>

<li><p>一旦操作的文本涉及到具体的指定编码表时，必须使用转换流</p></li>
</ol>

<p>下面以系统的输入输出流(字节)读写到文本文件为例</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> <span style="color:#f92672">{</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     *  读取系统输入（字节）
</span><span style="color:#75715e">     *  写入到文件中（字符）
</span><span style="color:#75715e">     */</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">readTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 将系统输入流转为字符流进行读取
</span><span style="color:#75715e"></span>        BufferedReader reader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> InputStreamReader<span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">in</span><span style="color:#f92672">));</span>
        BufferedWriter writer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedWriter<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileWrite<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/output.txt&#34;</span><span style="color:#f92672">));</span>

        <span style="color:#75715e">// BufferedReader 的 readLine() 获取的是字符串
</span><span style="color:#75715e"></span>        String data<span style="color:#f92672">;</span>
        <span style="color:#75715e">// 当读取系统输入为 “exit” 时，停止读取
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(!</span> <span style="color:#e6db74">&#34;exit&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>data <span style="color:#f92672">=</span> reader<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">()))</span> <span style="color:#f92672">{</span>
            writer<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>data<span style="color:#f92672">);</span>
            writer<span style="color:#f92672">.</span><span style="color:#a6e22e">newLine</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>writer <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            writer<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>reader <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            reader<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

<span style="color:#75715e">/*-----------------------分割线-----------------------*/</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     *  从文件中读取数据（字符）
</span><span style="color:#75715e">     *  写入数据到系统输出（字节）
</span><span style="color:#75715e">     */</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writeTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 将系统输入流转为字符流进行读取
</span><span style="color:#75715e"></span>        BufferedReader reader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileReader<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;xx/input.txt&#34;</span><span style="color:#f92672">));</span>
        BufferedWriter writer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedWriter<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> OutputStreamWriter<span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">));</span>
        
        <span style="color:#75715e">// BufferedReader 的 readLine() 获取的是字符串
</span><span style="color:#75715e"></span>        String data<span style="color:#f92672">;</span>
        <span style="color:#75715e">// 读写数据
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">((</span>data <span style="color:#f92672">=</span> reader<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            writer<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>data<span style="color:#f92672">);</span>
            writer<span style="color:#f92672">.</span><span style="color:#a6e22e">newLine</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>writer <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            writer<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>reader <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            reader<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<hr />

<h3 id="a-name-数据流-数据流-a-datainputstream-dataoutputstream"><a name="数据流">数据流</a> (DataInputStream &amp; DataOutputStream)</h3>

<p>数据流支持 Java 的基本类型读写，但要注意的是，所读的文件必须是用数据流 <code>DataOutputStream</code> 写入的数据文件，不然会造成 <strong>字符编码问题</strong></p>

<p><a href="https://docs.oracle.com/javase/tutorial/essential/io/datastreams.html">例子来源于官网教程</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// 定义一个全局变量的文件名, 没有后缀，即使给了后缀打开也是乱码
</span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String dataFile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;invoicedata&#34;</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> *  用数据流写入数据
</span><span style="color:#75715e"> */</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">dataWriteStream</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 定义一些要写入的变量
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">double</span><span style="color:#f92672">[]</span> prices <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>19<span style="color:#f92672">.</span><span style="color:#a6e22e">99</span><span style="color:#f92672">,</span> 9<span style="color:#f92672">.</span><span style="color:#a6e22e">99</span><span style="color:#f92672">,</span> 15<span style="color:#f92672">.</span><span style="color:#a6e22e">99</span><span style="color:#f92672">,</span> 3<span style="color:#f92672">.</span><span style="color:#a6e22e">99</span><span style="color:#f92672">,</span> 4<span style="color:#f92672">.</span><span style="color:#a6e22e">99</span><span style="color:#f92672">};</span>
        <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> units <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> 12<span style="color:#f92672">,</span> 8<span style="color:#f92672">,</span> 13<span style="color:#f92672">,</span> 29<span style="color:#f92672">,</span> 50 <span style="color:#f92672">};</span>
        <span style="color:#66d9ef">final</span> String<span style="color:#f92672">[]</span> descs <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;Java T-shirt&#34;</span><span style="color:#f92672">,</span>
                <span style="color:#e6db74">&#34;Java Mug&#34;</span><span style="color:#f92672">,</span>
                <span style="color:#e6db74">&#34;Duke Juggling Dolls&#34;</span><span style="color:#f92672">,</span>
                <span style="color:#e6db74">&#34;Java Pin&#34;</span><span style="color:#f92672">,</span>
                <span style="color:#e6db74">&#34;Java Key Chain&#34;</span>
        <span style="color:#f92672">};</span>

        <span style="color:#75715e">// create out stream and write data into specify file
</span><span style="color:#75715e"></span>        DataOutputStream out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DataOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> BufferedOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>dataFile<span style="color:#f92672">)));</span>
        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> prices<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeDouble</span><span style="color:#f92672">(</span>prices<span style="color:#f92672">[</span>i<span style="color:#f92672">]);</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span>units<span style="color:#f92672">[</span>i<span style="color:#f92672">]);</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeUTF</span><span style="color:#f92672">(</span>descs<span style="color:#f92672">[</span>i<span style="color:#f92672">]);</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>out <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

<span style="color:#75715e">/*******************分割线*********************/</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> *  用数据流读取写好的数据
</span><span style="color:#75715e"> */</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">dataReadTest</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        <span style="color:#75715e">// create in stream and read data from specify file
</span><span style="color:#75715e"></span>        DataInputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DataInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> BufferedInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>dataFile<span style="color:#f92672">)));</span>
        <span style="color:#75715e">// 定义接受不同类型数据的变量
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">double</span> price<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> unit<span style="color:#f92672">;</span>
        String desc<span style="color:#f92672">;</span>

        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#75715e">// 读取数据的类型要与写入时的保持一致
</span><span style="color:#75715e"></span>                price <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readDouble</span><span style="color:#f92672">();</span>
                unit <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
                desc <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readUTF</span><span style="color:#f92672">();</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">format</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;You ordered %d&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; units of %s at %.2f%n&#34;</span><span style="color:#f92672">,</span> unit<span style="color:#f92672">,</span> desc<span style="color:#f92672">,</span> price<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>EOFException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span></code></pre></div>
<p><strong style="color: #4f4">注意</strong>:</p>

<p>DataStreams 通过捕获 <code>EOFException</code> 来检测文件结束条件，而不是测试无效的返回值。</p>

<hr />

<h3 id="a-name-对象流-对象流-a-objectinputstream-objectoutputstream"><a name="对象流">对象流</a> (ObjectInputStream &amp; ObjectOutputStream)</h3>

<p>跟数据流一样，对象流支持读写对象，通过 <code>ObjectOutputStream</code> 将对象序列化，然后存储到磁盘中或发布到网上，用户再通过 <code>ObjectIntputStream</code> 将数据反序列化为对象，然后操作使用。所以想要用对象流，那么该对象就必须是 <strong>实现 <code>Serializable</code> 接口类的实例</strong>。</p>

<p>跟数据流相比，对象流的数据类型就更加的丰富了，不仅有基本的数据类型，还可能包含其他的对象。下面仍然是订单的例子，只不过它的价格属性用的是 <code>Math.BigDecimal</code> 类，BigDecimal 类是用来计算 <strong>更高精度要求的小数</strong>，比如商业的金钱交易，使用它的算术方法来进行加减乘除运算，而不是用运算符运算。下面的例子来源于<a href="https://docs.oracle.com/javase/tutorial/essential/io/objectstreams.html">官方教程</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ObjectStreams</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// 定义数据
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String dataFile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;invoicedata&#34;</span><span style="color:#f92672">;</span>

    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> BigDecimal<span style="color:#f92672">[]</span> prices <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> 
        <span style="color:#66d9ef">new</span> BigDecimal<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;19.99&#34;</span><span style="color:#f92672">),</span> 
        <span style="color:#66d9ef">new</span> BigDecimal<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;9.99&#34;</span><span style="color:#f92672">),</span>
        <span style="color:#66d9ef">new</span> BigDecimal<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;15.99&#34;</span><span style="color:#f92672">),</span>
        <span style="color:#66d9ef">new</span> BigDecimal<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;3.99&#34;</span><span style="color:#f92672">),</span>
        <span style="color:#66d9ef">new</span> BigDecimal<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;4.99&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">};</span>
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> units <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> 12<span style="color:#f92672">,</span> 8<span style="color:#f92672">,</span> 13<span style="color:#f92672">,</span> 29<span style="color:#f92672">,</span> 50 <span style="color:#f92672">};</span>
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String<span style="color:#f92672">[]</span> descs <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> <span style="color:#e6db74">&#34;Java T-shirt&#34;</span><span style="color:#f92672">,</span>
            <span style="color:#e6db74">&#34;Java Mug&#34;</span><span style="color:#f92672">,</span>
            <span style="color:#e6db74">&#34;Duke Juggling Dolls&#34;</span><span style="color:#f92672">,</span>
            <span style="color:#e6db74">&#34;Java Pin&#34;</span><span style="color:#f92672">,</span>
            <span style="color:#e6db74">&#34;Java Key Chain&#34;</span> <span style="color:#f92672">};</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> 
        <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> ClassNotFoundException <span style="color:#f92672">{</span>

        <span style="color:#75715e">// 对象流写数据到文件
</span><span style="color:#75715e"></span>        ObjectOutputStream out <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span>
                    BufferedOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>dataFile<span style="color:#f92672">)));</span>
            <span style="color:#75715e">// 写入日期、价格、数量、名称到文件
</span><span style="color:#75715e"></span>            out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeObject</span><span style="color:#f92672">(</span>Calendar<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">());</span>
            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> prices<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i <span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeObject</span><span style="color:#f92672">(</span>prices<span style="color:#f92672">[</span>i<span style="color:#f92672">]);</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span>units<span style="color:#f92672">[</span>i<span style="color:#f92672">]);</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeUTF</span><span style="color:#f92672">(</span>descs<span style="color:#f92672">[</span>i<span style="color:#f92672">]);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span> <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>            out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>

<span style="color:#75715e">/********************分割线****************************/</span>

        <span style="color:#75715e">// 对象流从文件中读数据
</span><span style="color:#75715e"></span>        ObjectInputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span>
                    BufferedInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>dataFile<span style="color:#f92672">)));</span>
            <span style="color:#75715e">// 定义接收数据的变量
</span><span style="color:#75715e"></span>            Calendar date <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
            BigDecimal price<span style="color:#f92672">;</span>
            <span style="color:#66d9ef">int</span> unit<span style="color:#f92672">;</span>
            String desc<span style="color:#f92672">;</span>
            BigDecimal total <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BigDecimal<span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
            <span style="color:#75715e">// 先接收日期
</span><span style="color:#75715e"></span>            date <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>Calendar<span style="color:#f92672">)</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readObject</span><span style="color:#f92672">();</span>

            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">format</span> <span style="color:#f92672">(</span><span style="color:#e6db74">&#34;On %tA, %&lt;tB %&lt;te, %&lt;tY:%n&#34;</span><span style="color:#f92672">,</span> date<span style="color:#f92672">);</span>
            <span style="color:#75715e">// 跟数据流一样按照写入时的顺序读数据
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    price <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>BigDecimal<span style="color:#f92672">)</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readObject</span><span style="color:#f92672">();</span>
                    unit <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
                    desc <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readUTF</span><span style="color:#f92672">();</span>
                    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">format</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;You ordered %d units of %s at $%.2f%n&#34;</span><span style="color:#f92672">,</span>
                            unit<span style="color:#f92672">,</span> desc<span style="color:#f92672">,</span> price<span style="color:#f92672">);</span>
                    total <span style="color:#f92672">=</span> total<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>price<span style="color:#f92672">.</span><span style="color:#a6e22e">multiply</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> BigDecimal<span style="color:#f92672">(</span>unit<span style="color:#f92672">)));</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>EOFException e<span style="color:#f92672">)</span> <span style="color:#f92672">{}</span> <span style="color:#75715e">// 同样，等捕获到异常后退出循环
</span><span style="color:#75715e"></span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">format</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;For a TOTAL of: $%.2f%n&#34;</span><span style="color:#f92672">,</span> total<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span> <span style="color:#75715e">// 关流
</span><span style="color:#75715e"></span>            in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>

  

  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>About</h4>
    <p dir="auto">欢迎访问我的博客，这是我的 <a href="https://github.com/junq0420">Github</a></p>
  </section>
  

  
        <section class="sidebar-module">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/2024/04/python_basic/">Python_basic</a></li>

<li><a href="/2023/06/adt/">ADT</a></li>

<li><a href="/2023/05/c_code_style/">C_Code_Style</a></li>

<li><a href="/2023/05/c_grammar_jjz/">C_Grammar_JJZ</a></li>

<li><a href="/2023/05/lvgl_port/">LVGL_Port</a></li>

    </ol>
  </section>

  

  
  <section class="sidebar-module">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="https://www.bilibili.com/">Bilibili</a></li>
      
      <li><a href="https://www.google.com">Google</a></li>
      
    </ol>
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p dir="auto">
      
      除非特别声明, 本站采用技术 <a href="https://gohugo.io/">Hugo</a> &amp; 主题 <a href="https://themes.gohugo.io/themes/hugo-theme-bootstrap4-blog/">hugo-theme-bootstrap4-blog</a>.
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
